<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>HeyGen SDK Avatar</title>
  <script src="https://cdn.jsdelivr.net/npm/@heygen/streaming-avatar@latest/dist/index.umd.js"></script>
</head>
<body>
  <button onclick="startSession()">Start Speaking</button>
  <div id="avatar-container" style="width: 400px; height: 400px; border: 1px solid #ccc;"></div>

  <script>
    const token = 'NTg1MTQ0YzY1MTViNDM4YWEwNzEwODQwZWI0MjQzMDktMTc0NTk1MDc0OQ==';

    let avatar;

    async function startSession() {
      // âœ… FIX: Check window.StreamingAvatar exists
      if (!window.StreamingAvatar) {
        console.error("StreamingAvatar SDK not loaded!");
        alert("SDK failed to load. Please check your internet connection or SDK link.");
        return;
      }

      if (!avatar) {
        avatar = new window.StreamingAvatar({
          token: token,
          container: document.getElementById('avatar-container'),
        });
      }

      try {
        const session = await avatar.createStartAvatar({
          avatarName: 'Judy_Doctor_Standing2_public',
          quality: 'high'
        });

        await avatar.speak({
          sessionId: session.session_id,
          text: 'Hello from Wix!',
          task_type: 'REPEAT'
        });
      } catch (err) {
        console.error("Error starting avatar session:", err);
      }
    }
  </script>
</body>
</html>

